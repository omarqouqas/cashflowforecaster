@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  *,
  *::before,
  *::after {
    box-sizing: border-box;
  }

  html {
    scroll-behavior: smooth;
    /* Prevent pull-to-refresh on mobile */
    overscroll-behavior-y: contain;
  }

  body {
    @apply min-h-screen bg-white text-zinc-900 antialiased;
    /* Prevent text size adjustment on orientation change */
    -webkit-text-size-adjust: 100%;
  }

  /* Make "border" default to a crisp Zinc outline. */
  *,
  *::before,
  *::after {
    @apply border-zinc-200;
  }

  /* Improve tap highlighting on mobile */
  a,
  button {
    -webkit-tap-highlight-color: transparent;
  }

  /* Ensure inputs don't zoom on iOS */
  input,
  select,
  textarea {
    font-size: 16px;
  }
}

@layer components {
  /* Component patterns (Minimalist Utility) */
  .cfc-card {
    @apply rounded-lg border border-zinc-200 bg-white p-4;
  }

  .cfc-card-lg {
    @apply rounded-lg border border-zinc-200 bg-white p-6;
  }

  .cfc-badge {
    @apply inline-flex items-center rounded-md bg-zinc-100 px-2 py-1 text-xs font-medium text-zinc-600;
  }

  .cfc-divider {
    @apply divide-y divide-zinc-100;
  }

  /* Financial data helpers */
  .financial {
    @apply tabular-nums;
  }

  [data-financial] {
    @apply tabular-nums;
  }

  .cfc-balance {
    @apply text-2xl font-semibold tabular-nums tracking-tight;
  }

  .cfc-negative {
    @apply text-rose-600;
  }

  .cfc-date {
    @apply text-sm text-zinc-500;
  }

  /* Mobile touch-friendly button base */
  .touch-target {
    @apply min-h-[44px] min-w-[44px];
  }

  /* Bottom sheet styling */
  .bottom-sheet {
    @apply fixed bottom-0 left-0 right-0 bg-zinc-900 rounded-t-2xl;
    @apply transform transition-transform duration-300 ease-out;
    max-height: 85vh;
    max-height: 85dvh; /* Dynamic viewport height for mobile browsers */
  }

  .bottom-sheet-handle {
    @apply w-10 h-1 bg-zinc-600 rounded-full mx-auto mt-3 mb-2;
  }
}

@layer utilities {
  /* Accent selection (teal-600, used sparingly) */
  .selection-teal::selection {
    @apply bg-teal-600/20;
  }

  /* Hide scrollbar but keep functionality */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Prevent text selection on UI elements */
  .no-select {
    -webkit-user-select: none;
    user-select: none;
  }

  /* Hardware-accelerated animations */
  .gpu {
    transform: translateZ(0);
    backface-visibility: hidden;
  }

  /* Active state for touch feedback */
  .touch-active {
    @apply active:scale-[0.98] active:opacity-90 transition-transform duration-75;
  }

  /* Ensure proper stacking for fixed elements on mobile */
  .fixed-safe {
    position: fixed;
    left: env(safe-area-inset-left, 0px);
    right: env(safe-area-inset-right, 0px);
  }

  /* Shimmer loading animation for skeletons */
  @keyframes shimmer {
    0% {
      transform: translateX(-100%);
    }
    100% {
      transform: translateX(100%);
    }
  }

  .animate-shimmer {
    animation: shimmer 2s infinite;
  }

  /* Fade in animation for staggered reveals */
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fadeIn {
    animation: fadeIn 0.4s ease-out;
  }
}

/* Custom media query for devices with notches/safe areas */
@supports (padding-bottom: env(safe-area-inset-bottom)) {
  .has-safe-area {
    /* This class can be used to detect safe area support */
  }
}

/* Reduce motion for users who prefer it */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Dark mode scrollbar (for webkit browsers) */
@media (prefers-color-scheme: dark) {
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: #18181b; /* zinc-900 */
  }

  ::-webkit-scrollbar-thumb {
    background: #3f3f46; /* zinc-700 */
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: #52525b; /* zinc-600 */
  }
}

/* Blog prose typography improvements */
.prose p {
  margin-bottom: 1.5em;
  line-height: 1.8;
}

.prose h2 {
  margin-top: 2.5em;
  margin-bottom: 1em;
}

.prose h3 {
  margin-top: 2em;
  margin-bottom: 0.75em;
}

.prose ul,
.prose ol {
  margin-top: 1.25em;
  margin-bottom: 1.5em;
}

.prose li {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

.prose li p {
  margin-bottom: 0.5em;
}

/* Ensure first paragraph after heading doesn't have extra top margin */
.prose h2 + p,
.prose h3 + p {
  margin-top: 0;
}

/* Improve blockquote styling */
.prose blockquote {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
  padding-left: 1.25em;
  border-left-width: 3px;
}

/* Better code block spacing */
.prose pre {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}

/* Improve strong/bold readability in dark mode */
.prose-invert strong {
  color: #fff;
  font-weight: 600;
}